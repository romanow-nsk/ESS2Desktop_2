/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package romanow.abc.desktop.wizard;

import romanow.abc.core.entity.metadata.Meta2RegLink;

/**
 *
 * @author romanow
 */
public class WizardRegLinkPanel extends javax.swing.JPanel {

    /**
     * Creates new form WizardRegLinkPanel
     */
    private Meta2RegLink elem;
    private WizardMeta2GUI base;
    private String prefix;
    private boolean busy=false;
    public WizardRegLinkPanel(int x0, int y0, String prefix0, Meta2RegLink link0,WizardMeta2GUI base0) {
        initComponents();
        prefix = prefix0;
        if (prefix.length()!=0)
            prefix+=".";
        setBounds(x0,y0,235,60);
        elem = link0;
        base = base0;
        setVisible(true);
        setRegNum();
        }
    private void setRegNum(){
        busy = true;
        Equip.setText(elem.getEquipName());
        RegNum.setText(HEX.isSelected() ? "0x"+Integer.toString(elem.getRegNum(),16) : ""+elem.getRegNum());
        UnitIdx.setText(""+elem.getUnitIdx());
        OwnUnit.setSelected(elem.isOwnUnit());
        busy = false;
        }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Оборудование = new javax.swing.JLabel();
        RegNum = new javax.swing.JTextField();
        jLabel14 = new javax.swing.JLabel();
        Equip = new javax.swing.JTextField();
        HEX = new javax.swing.JCheckBox();
        UnitIdx = new javax.swing.JTextField();
        OwnUnit = new javax.swing.JCheckBox();

        setLayout(null);

        Оборудование.setText("Оборуд/Unit");
        add(Оборудование);
        Оборудование.setBounds(10, 10, 80, 14);

        RegNum.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                RegNumKeyPressed(evt);
            }
        });
        add(RegNum);
        RegNum.setBounds(130, 30, 70, 25);

        jLabel14.setText("Регистр");
        add(jLabel14);
        jLabel14.setBounds(130, 10, 50, 14);

        Equip.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                EquipKeyPressed(evt);
            }
        });
        add(Equip);
        Equip.setBounds(10, 30, 75, 25);

        HEX.setText("hex");
        HEX.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                HEXItemStateChanged(evt);
            }
        });
        add(HEX);
        HEX.setBounds(180, 5, 50, 23);

        UnitIdx.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                UnitIdxKeyPressed(evt);
            }
        });
        add(UnitIdx);
        UnitIdx.setBounds(90, 30, 30, 25);

        OwnUnit.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                OwnUnitItemStateChanged(evt);
            }
        });
        add(OwnUnit);
        OwnUnit.setBounds(95, 5, 20, 21);
    }// </editor-fold>//GEN-END:initComponents

    private void RegNumKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_RegNumKeyPressed
        base.onKeyPressed(prefix+"regNum", HEX, RegNum, evt, new I_WizardAction() {
            @Override
            public void onAction(int value) {
                elem.setRegNum(value);
            }
        });
    }//GEN-LAST:event_RegNumKeyPressed

    private void EquipKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_EquipKeyPressed
        base.onStringKeyPressed(prefix+"equipName", Equip, evt, new I_WizardActionString() {
            @Override
            public void onAction(String value) {
                elem.setEquipName(value);
            }
        });
    }//GEN-LAST:event_EquipKeyPressed

    private void HEXItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_HEXItemStateChanged
        setRegNum();
    }//GEN-LAST:event_HEXItemStateChanged

    private void UnitIdxKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_UnitIdxKeyPressed
        base.onKeyPressed(prefix+"UnitIdx", UnitIdx, evt, new I_WizardAction() {
            @Override
            public void onAction(int value) {
                elem.setUnitIdx(value);
            }
        });
    }//GEN-LAST:event_UnitIdxKeyPressed

    private void OwnUnitItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_OwnUnitItemStateChanged
        if (busy)
            return;
        elem.setOwnUnit(OwnUnit.isSelected());
        base.back.onEnter("Изменено ownUnit"+OwnUnit.isSelected());
    }//GEN-LAST:event_OwnUnitItemStateChanged


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField Equip;
    private javax.swing.JCheckBox HEX;
    private javax.swing.JCheckBox OwnUnit;
    private javax.swing.JTextField RegNum;
    private javax.swing.JTextField UnitIdx;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel Оборудование;
    // End of variables declaration//GEN-END:variables
}
